@{
    ViewData["Title"] = "Thêm sản phẩm (Staff)";
    Layout = "~/Views/Shared/_StaffLayout.cshtml";
}
<h2>Thêm sản phẩm</h2>
<form id="createForm" enctype="multipart/form-data">
    <div class="mb-3">
        <label>Tên sản phẩm</label>
        <input type="text" class="form-control" name="productName" required />
    </div>
    <div class="mb-3">
        <label>Giá</label>
        <input type="number" class="form-control" name="price" required />
    </div>
    <div class="mb-3">
        <label>Brand</label>
        <select class="form-control" name="brandId" id="brandSelect" required></select>
    </div>
    <div class="mb-3">
        <label>Category</label>
        <select class="form-control" name="categoryId" id="categorySelect" required></select>
    </div>
    <div class="mb-3">
        <label>Ảnh sản phẩm</label>
        <input type="file" class="form-control" name="imageFile" accept="image/*" />
    </div>
    <button type="submit" class="btn btn-success">Thêm</button>
    <a href="@Url.Action("StaffProductList", "StaffProduct")" class="btn btn-secondary">Quay lại</a>
</form>
@section Scripts {
<script>
    // Load brand/category
    document.addEventListener('DOMContentLoaded', function () {
        fetch('http://localhost:5028/api/BrandManagement').then(r=>r.json()).then(data=>{
            let html = '';
            data.forEach(b=>html += `<option value='${b.id}'>${b.name}</option>`);
            document.getElementById('brandSelect').innerHTML = html;
        });
        fetch('http://localhost:5028/api/CategoriesManagement').then(r=>r.json()).then(data=>{
            let html = '';
            data.forEach(c=>html += `<option value='${c.id}'>${c.name}</option>`);
            document.getElementById('categorySelect').innerHTML = html;
        });
    });
    // Submit form
    document.getElementById('createForm').onsubmit = function(e) {
        e.preventDefault();
        var formData = new FormData(this);
        fetch('http://localhost:5028/api/ProductsManagement', {
            method: 'POST',
            body: formData
        })
        .then(res => {
            if(res.ok) window.location.href = '/StaffProduct/StaffProductList';
            else alert('Thêm sản phẩm thất bại!');
        });
    }
</script>
} 